var $=$||function(n,t){return t||(t=document),t.querySelector(n)},Noc;(function(){Array.prototype.interpolate=function(n){var t=this,e=function(n,t,i){return n+(t-n)*i},r=[],o=new Number((t.length-1)/(n-1)),i;for(r[0]=t[0],i=1;i<n-1;i++){var u=i*o,f=new Number(Math.floor(u)).toFixed(),s=new Number(Math.ceil(u)).toFixed(),h=u-f;r[i]=e(t[f],t[s],h)}return r[n-1]=t[t.length-1],r};Array.prototype.first=function(n){return n?(n<0&&(n=0),this.slice(0,n)):this[0]};Array.prototype.take=function(n){return n||(n=2),this.filter(function(t,i){if(i<n)return t})||[]};Array.prototype.findBy=function(n){for(var i=this,r=[],t=0;t<i.length;t++)n(i[t])&&r.push(i[t]);return r};Array.prototype.count=function(n){var r=this,i=0,t;if(!n)return this.length;for(t=0;t<this.length;t++)n(r[t])&&i++;return i};Array.prototype.findIndex=function(n){for(var i=this,t=0;t<this.length;t++)if(n(i[t]))return t;return-1};Array.prototype.remove=function(n){return this.splice(n,1),this.length};Array.prototype.clone=function(){return this.slice(0)};Array.prototype.removeAll=function(){for(var n=0;this.length;n++)this.splice(n,1);return this.length}})();window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(n){window.setTimeout(n,1e3/60)}}();Noc={Timer:{},Utils:{},Collision:{}};Noc.Collision.circularDetection=function(n,t){var i=n.x-t.x,r=n.y-t.y,u=n.r+t.r;return i*i+r*r<=u*u};Noc.Collision.rectangularDetection=function(n,t){return n.x<t.x+t.w&&n.x+n.w>t.x&&n.y<t.y+t.h&&n.h+n.y>t.y?!0:!1};Noc.Audio=function(){function n(){var n=this;this.audioBuffers={};this.keys=[];this.context=new AudioContext;this.load=function(t,i){this.keys.unshift(t);var r=new XMLHttpRequest;return r.open("GET",i,!0),r.responseType="arraybuffer",r.onload=function(){n.context.decodeAudioData(r.response,function(i){n.audioBuffers[t]=i;n.completed&&n.completed(t)},function(n){console.log(n)})},r.send(),this}}return n.prototype.completed=function(){},n.prototype.play=function(n,t){var i=this.context.createBufferSource();return i.buffer=this.audioBuffers[n],i.connect(this.context.destination),i.start(),t&&t(i),this},n.prototype.pause=function(){},n}();Noc.Point2D=function(){return function(n,t){this.x=n;this.y=t}}();Noc.Geometry=function(){var n=function(){this.name="";this.verticles=[];this.faces=[];this.faceVertexUvs=[[]];this.color="#ffffff"};return n.prototype.hasFaceVertexUv=function(){return this.faceVertexUvs[0]&&this.faceVertexUvs[0].length>0},n.prototype.hasFaceVertexUv2=function(){return this.faceVertexUvs[1]&&this.faceVertexUvs[1].length>0},n}();Noc.Face=function(){return function(n,t,i){this.a=n;this.b=t;this.c=i;this.materialIndex=0;this.vertexNormals={}}}();Noc.Point3D=function(){return function(n,t,i,r,u){this.x=n;this.y=t;this.z=i;this.u=r;this.v=u;this.rotateX=function(n){var t,i,r,u,f;return t=n*Math.PI/180,i=Math.cos(t),r=Math.sin(t),u=this.y*i-this.z*r,f=this.y*r+this.z*i,new Noc.Point3D(this.x,u,f,this.u,this.v)};this.rotateY=function(n){var t,i,r,u,f;return t=n*Math.PI/180,i=Math.cos(t),r=Math.sin(t),f=this.z*i-this.x*r,u=this.z*r+this.x*i,new Noc.Point3D(u,this.y,f,this.u,this.v)};this.rotateZ=function(n){var t,i,r,u,f;return t=n*Math.PI/180,i=Math.cos(t),r=Math.sin(t),u=this.x*i-this.y*r,f=this.x*r+this.y*i,new Noc.Point3D(u,f,this.z,this.u,this.v)};this.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};this.scale=function(n){this.x*=n;this.y*=n;this.z*=n};this.normalize=function(){var n=this.length();return n!=0?(this.x/=n,this.y/=n,this.z/=n,!0):!1};this.angle=function(n){var i=new Noc.Point3D(this.x,this.y,this.z,this.u,this.v),t,r;return i.normalize(),t=new Noc.Point3D(n.x,n.y,n.z),t.normalize(),r=i.dot(t),Math.acos(r)};this.cross=function(n){var t=new Noc.Point3D(this.x,this.y,this.z,this.u,this.v);t.x=this.y*n.z-this.z*n.y;t.y=this.z*n.x-this.x*n.z;t.z=this.x*n.y-this.y*n.x;this.x=t.x;this.y=t.y;this.z=t.z;this.w=t.w};this.dot=function(n){return this.x*n.x+this.y*n.y+this.z*n.z};this.project=function(n,t,i,r){var u,f,e;return u=i/(r+this.z),f=this.x*u+n/2,e=this.y*u+t/2,new Noc.Point3D(f,e,this.z,this.u,this.v)}}}();Noc.Timer.Fps=function(){var n=function(){this.elapsed=0;this.last=null};return n.prototype.tick=function(n){this.elapsed=n-(this.last||n)/1e3;this.last=n},n.prototype.current=function(){return Math.round(1/this.elapsed)},n}();Noc.Sprite=function(){function n(n,t,i,r,u,f,e){this.image=n;this.pos=t;this.size=i;this.speed=typeof r=="number"?r:0;this.frames=u;this._index=0;this.dir=f||"horizontal";this.once=e}return n.prototype.update=function(n){this._index+=this.speed*n},n.prototype.render=function(n,t){var i,r,u,f,e;if(Math.floor(this._index)>=this.frames.length&&t&&t(),this.speed>0){if(r=this.frames.length,u=Math.floor(this._index),i=this.frames[u%r],this.once&&u>=r){this.done=!0;return}}else i=0;f=this.pos[0];e=this.pos[1];this.dir=="vertical"?e+=i*this.size[1]:f+=i*this.size[0];n.drawImage(this.image,f,e,this.size[0],this.size[1],0,0,this.size[0],this.size[1])},n}();Noc.Images=function(){var n=function(){this.downloadQueue=[];this.successCount=0;this.errorCount=0;this.cache={}};return n.prototype.downloadAll=function(n){var t;for(this.downloadQueue.length===0&&n(),t=0;t<this.downloadQueue.length;t++){var u=this.downloadQueue[t],i=new Image,r=this;i.addEventListener("load",function(){r.successCount+=1;r.isDone()&&n()},!1);i.addEventListener("error",function(){r.errorCount+=1;r.isDone()&&n()},!1);i.src=u;this.cache[u]=i}},n.prototype.getAsset=function(n){return this.cache[n]},n.prototype.isDone=function(){return this.downloadQueue.length==this.successCount+this.errorCount},n}();Noc.BitMap=function(){return function(n,t,i){this.image=n;this.width=t;this.height=i}}();Noc.Assets=function(){var n=function(n,t){var i=this;this.imageAssets=new Noc.Images;this.audioAssets=new Noc.Audio;n.images.forEach(function(n){i.imageAssets.downloadQueue.push(n)});this.imageAssets.downloadAll(function(){t&&t()})};return n.prototype.getImage=function(n){var t=n;return this.imageAssets.cache[n]},n}();Noc.Engine=function(){var n=function(n,t,i){var r=this,u,f;this.viewport={canvas:document.querySelector(n),height:0,width:0,ctx:document.querySelector(n).getContext("2d"),mouse:undefined};this.viewport.width=i?i.clientWidth:this.viewport.canvas.width;this.viewport.height=i?i.clientHeight:this.viewport.canvas.height;this.viewport.canvas.width=i?i.clientWidth:this.viewport.canvas.width;this.viewport.canvas.height=i?i.clientHeight:this.viewport.canvas.height;this.fps=new Noc.Timer.Fps;this.onFrame=function(){};this.parent=i;this.entities=[];this.isReady=!1;this.scenes=[];this.world=t||{width:this.viewport.width,height:this.viewport.height};this.camera=new Noc.Camera(0,0,this.viewport.width,this.viewport.height,this.world.width,this.world.height);this.clear=function(){this.viewport.ctx.clearRect(0,0,this.viewport.width,this.viewport.height)};u=Date.now();f=function(n){r.clear();var t=Date.now(),i=(t-u)/1e3;r.fps.tick(i);r.entities.forEach(function(t,u){if(t.onRender)t.onRender(t.state,key,u);if(t.collidesWith.forEach(function(i){r.entities.filter(function(n){return n.type===i}).forEach(function(i){var u=i.collitionExpression(i.state),f=t.collitionExpression(t.state),r=Noc.Collision[t.collitionDetector](u,f);t.collided=r;r&&(t.onCollition,t.onCollition.apply(t,[n,i,t]),i.onCollition,i.onCollition.apply(i,[n,t,i]))})}),(t.push<=r.timeElapsed||t.push==0)&&(t.draw(r.viewport,i,n),t.lifetime&&n>t.lifetime&&t.onLifetimeend)){t.active=!1;t.onLifetimeend(t.key,n)}});r.camera&&r.camera.update();u=t};window.addEventListener("resize",function(n){r.parent?(r.viewport.canvas.height=r.parent.offsetHeight,r.viewport.canvas.width=r.parent.offsetWidth):(r.viewport.canvas.height=n.target.innerHeight,r.viewport.canvas.width=n.target.innerWidth)},!1),function e(n){requestAnimFrame(e);r.isReady&&(f(n),r.timeElapsed=n,r.onFrame&&r.onFrame.apply(r,[n,r.fps]))}();this.resize=function(){var n=document.createEvent("UIEvents");n.initUIEvent("resize",!0,!1,window,0);window.dispatchEvent(n)}};return n.prototype.getContext=function(){return this.viewport.ctx},n.prototype.addEntity=function(n,t){return n._engine=this,n.lifetime+=this.timeElapsed||0,this.entities.push(n),t&&t(),this},n.prototype.addEntities=function(){for(var t,n=0;n<arguments.length;n++)if(t=arguments[n],t instanceof Noc.Entity)this.addEntity(t);else throw"argument "+n+" is not an instance of  Noc.Entity";},n.prototype.registerEntities=function(n,t){var i=this;n.forEach(function(n){i.addEntity(n)});t&&t()},n.prototype.addScene=function(){throw"Not yet implemented";},n.prototype.removeScene=function(){throw"Not yet implemented";},n.prototype.start=function(){this.isReady=!this.isReady},n.prototype.removeEntity=function(n,t){var i=this.entities.findIndex(function(t){return t.id===n.id});return this.entities.remove(i),t&&t(),this},n}();Noc.Entity=function(){var n=function(n,t,i,r){this._engine=undefined;this.type="";this.id=Noc.Utils.newGuid();this.active=!0;this.state={};this.render=t;this.key=n;this.visible=!0;this.push=i|0;this.lifetime=r;this.collitionDetector="circularDetection";this.setCollitionDetector=function(n){return this.collitionDetector=n,this};this.setType=function(n){return this.type=n,this};this.toggle=function(){this.visible=!this.visible};this.init=function(n){return this.state=n,this};this.setState=function(n){return this.state=n,this};this.collidesWith=[];this.collitionExpression=function(){return this.state};this.collided=!1;this.onCollition=undefined;this.onRender=undefined;this.onLifetimeend=null};return n.prototype.draw=function(n,t,i){this.render(n,t,i)},n}();Noc.Boundary=function(){var n=function(n,t,i,r){this.left=n||0;this.top=t||0;this.width=i||0;this.height=r||0;this.right=this.left+this.width;this.bottom=this.top+this.height};return n.prototype.set=function(n,t,i,r){this.left=n;this.top=t;this.width=i||this.width;this.height=r||this.height;this.right=this.left+this.width;this.bottom=this.top+this.height},n.prototype.within=function(n){return n.left<=this.left&&n.right>=this.right&&n.top<=this.top&&n.bottom>=this.bottom},n.prototype.overlaps=function(n){return this.left<n.right&&n.left<this.right&&this.top<n.bottom&&n.top<this.bottom},n}();Noc.Camera=function(){var n={NONE:"none",HORIZONTAL:"horizontal",VERTICAL:"vertical",BOTH:"both"},t=function(t,i,r,u,f,e){this.xView=t||0;this.yView=i||0;this.xDeadZone=0;this.yDeadZone=0;this.wView=r;this.hView=u;this.axis=n.BOTH;this.followed=null;this.viewportRect=new Noc.Boundary(this.xView,this.yView,this.wView,this.hView);this.worldRect=new Noc.Boundary(0,0,f,e)};return t.prototype.follow=function(n,t,i){this.followed=n;this.xDeadZone=t||this.wView/2;this.yDeadZone=i||this.hView/2},t.prototype.update=function(){this.followed!=null&&((this.axis==n.HORIZONTAL||this.axis==n.BOTH)&&(this.followed.x-this.xView+this.xDeadZone>this.wView?this.xView=this.followed.x-(this.wView-this.xDeadZone):this.followed.x-this.xDeadZone<this.xView&&(this.xView=this.followed.x-this.xDeadZone)),(this.axis==n.VERTICAL||this.axis==n.BOTH)&&(this.followed.y-this.yView+this.yDeadZone>this.hView?this.yView=this.followed.y-(this.hView-this.yDeadZone):this.followed.y-this.yDeadZone<this.yView&&(this.yView=this.followed.y-this.yDeadZone)));this.viewportRect.set(this.xView,this.yView);this.viewportRect.within(this.worldRect)||(this.viewportRect.left<this.worldRect.left&&(this.xView=this.worldRect.left),this.viewportRect.top<this.worldRect.top&&(this.yView=this.worldRect.top),this.viewportRect.right>this.worldRect.right&&(this.xView=this.worldRect.right-this.wView),this.viewportRect.bottom>this.worldRect.bottom&&(this.yView=this.worldRect.bottom-this.hView))},t}();Noc.Colors={blendColors:function(n,t,i){var r=parseInt(n.slice(1),16),u=parseInt(t.slice(1),16),f=r>>16,e=r>>8&255,o=r&255,s=u>>16,h=u>>8&255,c=u&255;return"#"+(16777216+(Math.round((s-f)*i)+f)*65536+(Math.round((h-e)*i)+e)*256+(Math.round((c-o)*i)+o)).toString(16).slice(1)}};Noc.Utils={newGuid:function(n,t){for(t=n="";n++<36;t+=n*51&52?(n^15?8^Math.random()*(n^20?16:4):4).toString(16):"-");return t}};
//# sourceMappingURL=noc.engine.latest.min.js.map
